var $uploadCrop,tempFilename,rawImg,imageId;function readFile(e){if(e.files&&e.files[0]){var o=new FileReader;o.onload=function(e){$(".upload-demo").addClass("ready"),$("#cropImagePop").modal("show"),rawImg=e.target.result},o.readAsDataURL(e.files[0])}}$("#cropImagePop").on("shown.bs.modal",function(){if(!$("#upload-demo").data("croppie")){var e=$(this).find(".modal-dialog").outerHeight(!0);$uploadCrop=$("#upload-demo").croppie({viewport:{width:.5*e,height:.5*e*1,type:"circle"},boundary:{width:.5*e-1,height:.5*e*1-1},showZoomer:!0,enableOrientation:!0,enableExif:!0,enforceBoundary:!0})}$uploadCrop.croppie("bind",{url:rawImg}).then(function(){})}),$("#cropImagePop").on("hidden.bs.modal",function(){$("#upload-demo").croppie("destroy"),$(".item-img").val("")}),$(".item-img").on("change",function(){imageId=$(this).data("id"),tempFilename=$(this).val(),$("#cancelCropBtn").data("id",imageId),readFile(this)}),$("#cropImageBtn").on("click",function(){$uploadCrop.croppie("result",{type:"base64",format:"jpeg",size:{width:150,height:150},quality:.5}).then(function(e){upload_avatar(e),$("#cropImagePop").modal("hide")})}),$("#rotate-btn").click(function(){$uploadCrop.croppie("rotate",-90)});